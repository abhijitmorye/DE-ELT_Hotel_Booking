12-Apr-24 02:12:43 - Parent directory is /home/abhijitmorye/DE-ELT_Hotel_Booking
12-Apr-24 02:12:43 - Current directory is /home/abhijitmorye/DE-ELT_Hotel_Booking/elt
12-Apr-24 02:12:43 - JSON input directory is /home/abhijitmorye/DE-ELT_Hotel_Booking/elt/json_data/2024-04-12
12-Apr-24 02:12:43 - CSV Data directory is /home/abhijitmorye/DE-ELT_Hotel_Booking/elt/csv_data/2024-04-12
12-Apr-24 02:12:49 - Transform Spark session is created, processing further
12-Apr-24 02:12:49 - Transforming regions_ into csv format
12-Apr-24 02:12:55 - Error occured while transforming file, regions_ with spark, must be some encoding issue, trying xTransform appraoch
12-Apr-24 02:12:55 - Transforming district_ into csv format
12-Apr-24 02:12:59 - +--------+-------+-----------+----------------+---------------+--------+---------+
| city_id|country|district_id|        latitude|      longitude|    name|nr_hotels|
+--------+-------+-----------+----------------+---------------+--------+---------+
|-1456928|     fr|          1|48.8630297608954|2.3399184771677|1st arr.|      261|
|-1456928|     fr|          2|48.8678666848111|2.3460338586984|2nd arr.|      456|
+--------+-------+-----------+----------------+---------------+--------+---------+
only showing top 2 rows
12-Apr-24 02:12:59 - None
12-Apr-24 02:13:00 - City id column found in district_
12-Apr-24 02:13:00 - Transformation of district_ completed, time taken 0:00:05.110709
12-Apr-24 02:13:00 - Transforming cities_ into csv format
12-Apr-24 02:13:01 - +--------+-------+----------------+----------------+-----------------+---------+-------------+---------------+
| city_id|country|        latitude|       longitude|             name|nr_hotels|timezone_name|timezone_offset|
+--------+-------+----------------+----------------+-----------------+---------+-------------+---------------+
|-3881514|     pk|33.3194007873535|73.2596969604492|             Kary|        0| Asia/Karachi|              5|
|-3881466|     pk|34.0208015441895|71.5916976928711|Sarāj Malik Wazīr|        0| Asia/Karachi|              5|
+--------+-------+----------------+----------------+-----------------+---------+-------------+---------------+
only showing top 2 rows
12-Apr-24 02:13:01 - None
12-Apr-24 02:13:01 - City id column found in cities_
12-Apr-24 02:13:01 - Transformation of cities_ completed, time taken 0:00:01.312714
12-Apr-24 02:13:01 - Transforming hotel_types_ into csv format
12-Apr-24 02:13:02 - +-------------+-------------------+
|hotel_type_id|               name|
+-------------+-------------------+
|          201|         Apartments|
|          202|Guest accommodation|
+-------------+-------------------+
only showing top 2 rows
12-Apr-24 02:13:02 - None
12-Apr-24 02:13:02 - Transformation of hotel_types_ completed, time taken 0:00:00.934111
12-Apr-24 02:13:02 - Transforming country_ into csv format
12-Apr-24 02:13:03 - +-----------+-------+--------------------+
|       area|country|                name|
+-----------+-------+--------------------+
|     Europe|     ad|             Andorra|
|Middle East|     ae|United Arab Emirates|
+-----------+-------+--------------------+
only showing top 2 rows
12-Apr-24 02:13:03 - None
12-Apr-24 02:13:03 - Transformation of country_ completed, time taken 0:00:00.672194
12-Apr-24 02:13:03 - Transforming hotel_facility_types_ into csv format
12-Apr-24 02:13:04 - +----------------+----------------------+----------+
|facility_type_id|hotel_facility_type_id|      name|
+----------------+----------------------+----------+
|               1|                     2|   Parking|
|               7|                     3|Restaurant|
+----------------+----------------------+----------+
only showing top 2 rows
12-Apr-24 02:13:04 - None
12-Apr-24 02:13:04 - Transformation of hotel_facility_types_ completed, time taken 0:00:00.679325
12-Apr-24 02:13:04 - Transforming room_facility_types_ into csv format
12-Apr-24 02:13:04 - +----------------+-------------------+---------------------+
|facility_type_id|               name|room_facility_type_id|
+----------------+-------------------+---------------------+
|               7|   Tea/Coffee maker|                    1|
|               3|Internet facilities|                    2|
+----------------+-------------------+---------------------+
only showing top 2 rows
12-Apr-24 02:13:04 - None
12-Apr-24 02:13:04 - Transformation of room_facility_types_ completed, time taken 0:00:00.611611
12-Apr-24 02:13:04 - Transforming facility_types_ into csv format
12-Apr-24 02:13:05 - +----------------+----------+
|facility_type_id|      name|
+----------------+----------+
|               1|   General|
|               2|Activities|
+----------------+----------+
only showing top 2 rows
12-Apr-24 02:13:05 - None
12-Apr-24 02:13:05 - Transformation of facility_types_ completed, time taken 0:00:00.616793
12-Apr-24 02:13:05 - Transforming hotels_ into csv format
12-Apr-24 02:13:05 - Error occured while transforming file, hotels_ with spark, must be some encoding issue, trying xTransform appraoch
12-Apr-24 02:13:05 - Transforming chain_types_ into csv format
12-Apr-24 02:13:06 - Error occured while transforming file, chain_types_ with spark, must be some encoding issue, trying xTransform appraoch
12-Apr-24 02:13:06 - Transforming payment_types_ into csv format
12-Apr-24 02:13:06 - Error occured while transforming file, payment_types_ with spark, must be some encoding issue, trying xTransform appraoch
12-Apr-24 02:13:06 - Transforming room_types_ into csv format
12-Apr-24 02:13:06 - +------------------+------------+
|              name|room_type_id|
+------------------+------------+
|         Apartment|           1|
|Presidential Suite|           2|
+------------------+------------+
only showing top 2 rows
12-Apr-24 02:13:06 - None
12-Apr-24 02:13:07 - Transformation of room_types_ completed, time taken 0:00:00.485190
12-Apr-24 02:13:07 - Stopping spark sesion
12-Apr-24 02:13:07 - Transformation completed, time taken 0:00:24.062504
12-Apr-24 02:13:07 - Done. Returned value was: None
12-Apr-24 02:13:07 - ::group::Post task execution logs
12-Apr-24 02:13:07 - Marking task as SUCCESS. dag_id=elt_hotel_data, task_id=transform_hotel_api_data_task, execution_date=20240412T021232, start_date=20240412T021243, end_date=20240412T021307
